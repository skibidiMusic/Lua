-->> loadstrng
--[[
    
    local fileManager = loadstring(game:HttpGet('https://raw.githubusercontent.com/skibidiMusic/Lua/refs/heads/main/Roblox/Util/fileManager.lua'))()
]]

-->> src
local HttpService = game:GetService"HttpService"

local function fileNameFromPath(path: string)
    -- Get the last part after the last backslash (or the full string if none)
    local lastPart = path:match(".*\\(.*)") or path

    -- Remove the extension if present
    local nameOnly = lastPart:match("(.+)%..+$") or lastPart
    return nameOnly
end

local function filePathFromName(folderPath: string, name: string)
    return folderPath .. "/" .. name .. ".txt"
end

local fileManager = {}
fileManager.__index = fileManager

function fileManager.new(folderPath: string)
    if not isfolder(folderPath) then
        makefolder(folderPath)
    end
    return setmetatable({folderPath = folderPath}, fileManager)
end

function fileManager.getSave(self, fileName: string)
    local filePath = filePathFromName(self.folderPath, fileName)
    if isfile(filePath) then
        return HttpService:JSONDecode(readfile(filePath))
    end
end

function fileManager.getSaves(self)
    local files = listfiles(self.folderPath)
    local saves = {}
    for _, filePath in files do
        if isfolder(filePath) then continue end
        local fileName = fileNameFromPath(filePath)
        saves[fileName] = HttpService:JSONDecode(readfile(filePath))
    end
    return saves
end

function fileManager.delete(self, fileName: string)
    local filePath = filePathFromName(self.folderPath, fileName)
    if isfile(filePath) then
        delfile(filePath)
    end
end

function fileManager.save(self, fileName: string, configTable: {})
    local filePath = filePathFromName(self.folderPath, fileName)
    writefile(filePath, HttpService:JSONEncode(configTable))
end

return fileManager